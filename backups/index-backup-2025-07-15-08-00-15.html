<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•ã Krav Maga Academy - Dashboard</title>
    
    <!-- Core CSS -->
    <link rel="stylesheet" href="/css/core/layout.css">
    <link rel="stylesheet" href="/css/core/components.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    
    <!-- Module CSS -->
    <link rel="stylesheet" href="/css/students.css">
    <link rel="stylesheet" href="/css/classes.css">
    <link rel="stylesheet" href="/css/plans.css">
</head>
<body>
    <div class="dashboard-container" id="dashboardContainer">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <div class="header-title">
                    <span>ü•ã</span>
                    Krav Academy
                </div>
                <div class="header-ai-status">
                    <span>ü§ñ</span>
                    5 Agentes Ativos
                </div>
            </div>
            <div class="header-actions">
                <button class="quick-action-btn" onclick="toggleSidebar()">
                    ‚ò∞ Menu
                </button>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="dashboard-sidebar" id="dashboardSidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Gest√£o Principal</div>
                <nav>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <button class="nav-link active" data-page="dashboard" data-ai-enabled="true">
                                <span class="nav-icon">üìä</span>
                                Dashboard IA
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="students" data-ai-enabled="true">
                                <span class="nav-icon">üë•</span>
                                Gest√£o de Alunos
                                <span class="badge success">INTEGRADO</span>
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="classes" data-ai-enabled="true">
                                <span class="nav-icon">üè´</span>
                                Gest√£o de Turmas
                                <span class="badge success">INTEGRADO</span>
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="evaluations" data-ai-enabled="true">
                                <span class="nav-icon">üìù</span>
                                Avalia√ß√µes
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="progress">
                                <span class="nav-icon">üìà</span>
                                Progresso
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="financial" data-ai-enabled="false">
                                <span class="nav-icon">üí∞</span>
                                Gest√£o Financeira
                                <span class="badge info" id="financial-count">0</span>
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="financial-responsibles" data-ai-enabled="false">
                                <span class="nav-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                                Respons√°veis Financeiros
                                <span class="badge info" id="responsibles-count">0</span>
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="subscriptions" data-ai-enabled="true">
                                <span class="nav-icon">üí≥</span>
                                Gest√£o de Assinaturas
                                <span class="badge warning" id="subscriptions-count">0</span>
                            </button>
                        </li>
                    </ul>
                </nav>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Sistema</div>
                <nav>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <button class="nav-link" data-page="attendance">
                                <span class="nav-icon">üìã</span>
                                Presen√ßa
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="public-checkin">
                                <span class="nav-icon">üì≤</span>
                                Check-in P√∫blico
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="knowledge">
                                <span class="nav-icon">üß†</span>
                                Base de Conhecimento
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-page="settings">
                                <span class="nav-icon">‚öôÔ∏è</span>
                                Configura√ß√µes
                            </button>
                        </li>
                    </ul>
                </nav>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Acesso R√°pido</div>
                <nav>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <button class="nav-link" onclick="window.open('/views/plans.html', '_blank')">
                                <span class="nav-icon">üìã</span>
                                Planos (Nova Aba)
                            </button>
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="page-header">
                    <h1>üìä Dashboard</h1>
                    <p>Vis√£o geral do sistema e m√©tricas principais</p>
                </div>

                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üë• Alunos Ativos</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-value" id="student-count">0</div>
                            <div class="metric-label">Total de alunos cadastrados</div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-primary" onclick="window.location.href='/views/students.html'">
                                Ver Todos
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üè´ Turmas Ativas</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-value" id="classes-count">0</div>
                            <div class="metric-label">Turmas em andamento</div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-success" onclick="window.location.href='/views/courses.html'">
                                Gerenciar
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üí∞ Receita Mensal</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-value" id="revenue-count">R$ 0</div>
                            <div class="metric-label">Faturamento do m√™s</div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-info" onclick="showSection('financial')">
                                Ver Detalhes
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Students Section -->
            <section id="students" class="content-section">
                <div class="page-header">
                    <h1>üë• Gest√£o de Alunos</h1>
                    <p>Cadastro e gerenciamento de alunos</p>
                </div>
                <div id="students-content">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <div>Carregando alunos...</div>
                    </div>
                </div>
            </section>

            <!-- Classes Section -->
            <section id="classes" class="content-section">
                <div class="page-header">
                    <h1>üè´ Gest√£o de Turmas</h1>
                    <p>Organiza√ß√£o de turmas e hor√°rios</p>
                </div>
                <div id="classes-content">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <div>Carregando turmas...</div>
                    </div>
                </div>
            </section>

            <!-- Financial Section -->
            <section id="financial" class="content-section">
                <div class="page-header">
                    <h1>üí∞ Gest√£o Financeira</h1>
                    <p>Controle financeiro e pagamentos</p>
                </div>
                <div id="financial-content">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <div>Carregando dados financeiros...</div>
                    </div>
                </div>
            </section>

            <!-- Attendance Section -->
            <section id="attendance" class="content-section">
                <div class="page-header">
                    <h1>üìã Controle de Presen√ßa</h1>
                    <p>Registro e acompanhamento de frequ√™ncia</p>
                </div>
                <div id="attendance-content">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <div>Carregando dados de presen√ßa...</div>
                    </div>
                </div>
            </section>

            <!-- Public Check-in Section -->
            <section id="public-checkin" class="content-section">
                <div class="page-header">
                    <h1>üì≤ Check-in P√∫blico</h1>
                    <p>Portal de entrada para alunos</p>
                </div>
                <div id="student-portal-content">
                    <div class="card">
                        <div class="card-body" style="text-align: center; padding: 3rem;">
                            <div style="font-size: 4rem; margin-bottom: 2rem;">ü•ã</div>
                            <h2 style="margin-bottom: 1rem;">Portal do Aluno</h2>
                            <p style="color: #94a3b8; margin-bottom: 2rem;">Digite seu c√≥digo de matr√≠cula</p>
                            <div class="form-group">
                                <input type="text" id="student-code" class="form-input" placeholder="C√≥digo de matr√≠cula" style="max-width: 300px; margin: 0 auto;">
                            </div>
                            <button onclick="loginStudent()" class="btn btn-primary">
                                Entrar
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <div class="page-header">
                    <h1>‚öôÔ∏è Configura√ß√µes</h1>
                    <p>Configura√ß√µes do sistema e prefer√™ncias</p>
                </div>
                <div id="settings-content">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Configura√ß√µes Gerais</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Nome da Academia</label>
                                <input type="text" id="academy-name" class="form-input" value="Krav Maga Academy">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <input type="checkbox" id="notifications" class="form-checkbox">
                                    Ativar notifica√ß√µes
                                </label>
                            </div>
                        </div>
                        <div class="card-footer">
                            <button class="btn btn-primary" onclick="saveSettings()">
                                Salvar Configura√ß√µes
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Other sections will be populated by modules -->
            <section id="evaluations" class="content-section">
                <div class="empty-state">
                    <div class="empty-state-icon">üìù</div>
                    <div class="empty-state-title">Avalia√ß√µes</div>
                    <div class="empty-state-description">Sistema de avalia√ß√µes em desenvolvimento</div>
                </div>
            </section>

            <section id="progress" class="content-section">
                <div class="empty-state">
                    <div class="empty-state-icon">üìà</div>
                    <div class="empty-state-title">Progresso</div>
                    <div class="empty-state-description">Acompanhamento de progresso em desenvolvimento</div>
                </div>
            </section>

            <section id="knowledge" class="content-section">
                <div class="empty-state">
                    <div class="empty-state-icon">üß†</div>
                    <div class="empty-state-title">Base de Conhecimento</div>
                    <div class="empty-state-description">Sistema de conhecimento em desenvolvimento</div>
                </div>
            </section>

            <section id="financial-responsibles" class="content-section">
                <div class="page-header">
                    <h1>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Respons√°veis Financeiros</h1>
                    <p>Gest√£o de respons√°veis por pagamentos</p>
                </div>
                <div id="financial-responsibles-content">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <div>Carregando respons√°veis...</div>
                    </div>
                </div>
            </section>

            <section id="subscriptions" class="content-section">
                <div class="page-header">
                    <h1>üí≥ Gest√£o de Assinaturas</h1>
                    <p>Gerencie assinaturas ativas dos alunos, planos contratados e status de pagamento</p>
                </div>
                <div id="subscriptions-content">
                    <div class="loading-container">
                        <div class="loading-spinner"></div>
                        <div>Carregando assinaturas...</div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Core JavaScript -->
    <script src="/js/utils/dom-helpers.js"></script>
    <script src="/js/utils/formatters.js"></script>
    <script src="/js/core/api-client.js"></script>
    <script src="/js/core/navigation.js"></script>
    
    <!-- Module JavaScript -->
    <script src="/js/utils.js"></script>
    <script src="/js/students.js"></script>
    <script src="/js/modules/students.js"></script>
    <script src="/js/modules/classes.js"></script>
    <script src="/js/attendance.js"></script>
    <script src="/js/financial.js"></script>
    
    <!-- Main Application -->
    <script src="/js/core/app.js"></script>

    <!-- Legacy compatibility functions -->
    <script>
        // Legacy functions for backward compatibility
        function loginStudent() {
            const code = document.getElementById('student-code')?.value;
            if (code) {
                console.log('üîë Student login attempt:', code);
                // TODO: Implement student login
                alert('Sistema de login em desenvolvimento');
            } else {
                alert('Por favor, digite seu c√≥digo de matr√≠cula');
            }
        }

        function saveSettings() {
            const academyName = document.getElementById('academy-name')?.value;
            const notifications = document.getElementById('notifications')?.checked;
            
            console.log('üíæ Saving settings:', { academyName, notifications });
            
            // Save to localStorage as backup
            localStorage.setItem('academySettings', JSON.stringify({
                academyName,
                notifications,
                lastUpdated: new Date().toISOString()
            }));
            
            if (window.app) {
                window.app.showToast('Configura√ß√µes salvas com sucesso!', 'success');
            } else {
                alert('Configura√ß√µes salvas!');
            }
        }

        // Load settings on page load
        function loadSettings() {
            try {
                const saved = localStorage.getItem('academySettings');
                if (saved) {
                    const settings = JSON.parse(saved);
                    const academyNameEl = document.getElementById('academy-name');
                    const notificationsEl = document.getElementById('notifications');
                    
                    if (academyNameEl && settings.academyName) {
                        academyNameEl.value = settings.academyName;
                    }
                    if (notificationsEl && typeof settings.notifications === 'boolean') {
                        notificationsEl.checked = settings.notifications;
                    }
                }
            } catch (error) {
                console.error('‚ùå Error loading settings:', error);
            }
        }

        // Load settings when page is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadSettings);
        } else {
            loadSettings();
        }
    </script>
</body>
</html>