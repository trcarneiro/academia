
[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mH:/projetos/academia[39m

{"level":30,"time":1769254777440,"pid":81352,"hostname":"C02","msg":"AgentExecutorService initialized with Gemini API"}
Sourcemap for "H:/projetos/academia/node_modules/node-cron/dist/esm/node-cron.js" points to missing source files
{"level":30,"time":1769254785727,"pid":81352,"hostname":"C02","msg":"âœ… Gemini AI Service initialized successfully"}
[90mstdout[2m | tests/integration/financial-module.test.ts
[22m[39m[Gemini] SDK inicializado com chave: AIzaSyCNPl...

{"level":30,"time":1769254785792,"pid":81352,"hostname":"C02","msg":"ğŸ“ Serving static files from: H:\\projetos\\academia\\public"}
{"level":30,"time":1769254785804,"pid":81352,"hostname":"C02","msg":"âœ… Health check routes registered (5 endpoints)"}
{"level":30,"time":1769254786357,"pid":81352,"hostname":"C02","msg":"âœ… CRM routes registered"}
{"level":30,"time":1769254786495,"pid":81352,"hostname":"C02","msg":"Biometric routes registered successfully (8 endpoints)"}
{"level":30,"time":1769254787434,"pid":81352,"hostname":"C02","msg":"Server running at http://0.0.0.0:3000"}
{"level":30,"time":1769254787434,"pid":81352,"hostname":"C02","msg":"âœ… HTTP Server is ready and accepting connections"}
{"level":30,"time":1769254787434,"pid":81352,"hostname":"C02","msg":"â³ Initializing Cron Scheduler..."}
{"level":30,"time":1769254787478,"pid":81352,"hostname":"C02","msg":"âœ… Cron Scheduler initialized (Daily at 02:00 AM)"}
 [31mâ¯[39m tests/integration/financial-module.test.ts [2m([22m[2m15 tests[22m[2m | [22m[33m15 skipped[39m[2m)[22m[33m 3499[2mms[22m[39m
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mBilling Plans API[2m > [22mshould list all billing plans
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mBilling Plans API[2m > [22mshould get billing plan by ID
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mBilling Plans API[2m > [22mshould create a new billing plan
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mBilling Plans API[2m > [22mshould update a billing plan
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mBilling Plans API[2m > [22mshould delete a billing plan
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mStudent Subscriptions API[2m > [22mshould list student subscriptions
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mStudent Subscriptions API[2m > [22mshould create a new subscription
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mStudent Subscriptions API[2m > [22mshould not create duplicate active subscriptions
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mStudent Subscriptions API[2m > [22mshould cancel a subscription
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mStudent Subscriptions API[2m > [22mshould get subscription details
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mFinancial Data Validation[2m > [22mshould validate subscription data
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mFinancial Data Validation[2m > [22mshould handle non-existent student
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mFinancial Data Validation[2m > [22mshould handle non-existent plan
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mPayment Processing[2m > [22mshould record payment for subscription
   [2m[90mâ†“[39m[22m Financial Module Integration Tests[2m > [22mPayment Processing[2m > [22mshould get payment history for student

[31mâ¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Suites 1 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m tests/integration/financial-module.test.ts[2m > [22mFinancial Module Integration Tests
[31m[1mPrismaClientValidationError[22m: 
Invalid `prisma.student.create()` invocation in
H:\projetos\academia\tests\integration\financial-module.test.ts:23:44

  20 });
  21 
  22 // Create test data
â†’ 23 testStudent = await prisma.student.create({
       data: {
         id: "test-student-fin-1769254789381",
         category: "ADULT",
         organizationId: "1af1edf1-0efc-4dd4-b94d-e779b72b44a8",
         user: {
           create: {
             firstName: "Test",
             lastName: "Student",
             email: "test.financial.1769254789381@example.com",
             phone: "(11) 99999-9999",
             password: "test123",
             organizationId: "1af1edf1-0efc-4dd4-b94d-e779b72b44a8"
           }
         },
         specialNeeds: [],
         preferredDays: [],
         preferredTimes: [],
     +   organization: {
     +     create: OrganizationCreateWithoutStudentsInput | OrganizationUncheckedCreateWithoutStudentsInput,
     +     connectOrCreate: OrganizationCreateOrConnectWithoutStudentsInput,
     +     connect: OrganizationWhereUniqueInput
     +   }
       },
       include: {
         user: true
       }
     })

Argument `organization` is missing.[39m
[90m [2mâ¯[22m throwValidationException node_modules/@prisma/client/src/runtime/core/errorRendering/throwValidationException.ts:[2m45:9[22m[39m
[90m [2mâ¯[22m ei.handleRequestError node_modules/@prisma/client/src/runtime/RequestHandler.ts:[2m202:7[22m[39m
[90m [2mâ¯[22m ei.handleAndLogRequestError node_modules/@prisma/client/src/runtime/RequestHandler.ts:[2m174:12[22m[39m
[90m [2mâ¯[22m ei.request node_modules/@prisma/client/src/runtime/RequestHandler.ts:[2m143:12[22m[39m
[90m [2mâ¯[22m a node_modules/@prisma/client/src/runtime/getPrismaClient.ts:[2m833:24[22m[39m
[36m [2mâ¯[22m tests/integration/financial-module.test.ts:[2m23:23[22m[39m
    [90m 21| [39m
    [90m 22| [39m        [90m// Create test data[39m
    [90m 23| [39m        testStudent [33m=[39m [35mawait[39m prisma[33m.[39mstudent[33m.[39m[34mcreate[39m({
    [90m   | [39m                      [31m^[39m
    [90m 24| [39m            data[33m:[39m {
    [90m 25| [39m                id[33m:[39m [32m`test-student-fin-[39m[36m${[39m[33mDate[39m[33m.[39m[34mnow[39m()[36m}[39m[32m`[39m[33m,[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/1]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [33m15 skipped[39m[90m (15)[39m
[2m   Start at [22m 08:39:32
[2m   Duration [22m 18.62s[2m (transform 5.24s, setup 93ms, collect 12.62s, tests 3.50s, environment 0ms, prepare 269ms)[22m

