<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü•ã Krav Maga Academy - Dashboard Principal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1f2937, #3b82f6);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #f59e0b;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.8;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .stat-card h3 {
            font-size: 2em;
            color: #f59e0b;
            margin-bottom: 10px;
        }
        
        .stat-card p {
            opacity: 0.8;
        }
        
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .action-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .action-card h3 {
            color: #f59e0b;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .btn {
            background: #f59e0b;
            color: #1f2937;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background: #d97706;
            transform: translateY(-2px);
        }
        
        .api-test {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .response-area {
            background: #1f2937;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            margin-left: 10px;
        }
        
        .status.online {
            background: #10b981;
            color: white;
        }
        
        .status.offline {
            background: #ef4444;
            color: white;
        }
        
        .loading {
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•ã Krav Maga Academy</h1>
            <p>Sistema de Gest√£o Completo com IA Integrada</p>
            <span id="serverStatus" class="status offline">Verificando...</span>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <h3 id="organizationsCount">-</h3>
                <p>Academias Cadastradas</p>
            </div>
            <div class="stat-card">
                <h3 id="studentsCount">-</h3>
                <p>Alunos Ativos</p>
            </div>
            <div class="stat-card">
                <h3 id="techniquesCount">-</h3>
                <p>T√©cnicas Dispon√≠veis</p>
            </div>
            <div class="stat-card">
                <h3 id="apiStatus">-</h3>
                <p>Status da API</p>
            </div>
        </div>
        
        <div class="actions-grid">
            <div class="action-card">
                <h3>üè¢ Gest√£o de Academias</h3>
                <p>Gerencie organiza√ß√µes, configura√ß√µes e planos.</p>
                <button class="btn" onclick="testEndpoint('organizations')">Ver Academias</button>
                <button class="btn" onclick="createSampleOrg()">Criar Academia Exemplo</button>
            </div>
            
            <div class="action-card">
                <h3>üë• Gest√£o de Alunos</h3>
                <p>Cadastro, matr√≠cula e acompanhamento de progresso.</p>
                <button class="btn" onclick="testEndpoint('students')">Ver Alunos</button>
                <button class="btn" onclick="createSampleStudent()">Criar Aluno Exemplo</button>
            </div>
            
            <div class="action-card">
                <h3>ü•ä T√©cnicas e Cursos</h3>
                <p>Biblioteca de t√©cnicas e curriculum de 24 semanas.</p>
                <button class="btn" onclick="testEndpoint('techniques')">Ver T√©cnicas</button>
                <button class="btn" onclick="createSampleTechnique()">Criar T√©cnica Exemplo</button>
            </div>
            
            <div class="action-card">
                <h3>üìä Analytics e IA</h3>
                <p>Insights, an√°lise de progresso e recomenda√ß√µes.</p>
                <button class="btn" onclick="testEndpoint('health')">Status do Sistema</button>
                <button class="btn" onclick="testAnalytics()">Ver Analytics</button>
            </div>
        </div>
        
        <div class="api-test">
            <h3>üîß Teste da API</h3>
            <p>Teste os endpoints da sua API diretamente:</p>
            <div>
                <button class="btn" onclick="testEndpoint('health')">Health Check</button>
                <button class="btn" onclick="testEndpoint('organizations')">Organiza√ß√µes</button>
                <button class="btn" onclick="testEndpoint('students')">Alunos</button>
                <button class="btn" onclick="testEndpoint('techniques')">T√©cnicas</button>
            </div>
            <div class="response-area" id="responseArea">
Clique em um bot√£o para testar a API...
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3000/api';
        
        // Check server status on load
        checkServerStatus();
        loadDashboardData();
        
        async function checkServerStatus() {
            try {
                const response = await fetch('http://localhost:3000/health');
                const data = await response.json();
                
                if (data.status === 'healthy') {
                    document.getElementById('serverStatus').textContent = 'Online';
                    document.getElementById('serverStatus').className = 'status online';
                    document.getElementById('apiStatus').textContent = '‚úÖ Online';
                } else {
                    throw new Error('Server not healthy');
                }
            } catch (error) {
                document.getElementById('serverStatus').textContent = 'Offline';
                document.getElementById('serverStatus').className = 'status offline';
                document.getElementById('apiStatus').textContent = '‚ùå Offline';
            }
        }
        
        async function loadDashboardData() {
            try {
                // Load organizations count
                const orgsResponse = await fetch(`${API_BASE}/organizations`);
                const orgsData = await orgsResponse.json();
                document.getElementById('organizationsCount').textContent = 
                    orgsData.success ? orgsData.data.length : '0';
                
                // Load students count
                const studentsResponse = await fetch(`${API_BASE}/students`);
                const studentsData = await studentsResponse.json();
                document.getElementById('studentsCount').textContent = 
                    studentsData.success ? studentsData.data.length : '0';
                
                // Load techniques count
                const techniquesResponse = await fetch(`${API_BASE}/techniques`);
                const techniquesData = await techniquesResponse.json();
                document.getElementById('techniquesCount').textContent = 
                    techniquesData.success ? techniquesData.data.length : '0';
                    
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }
        
        async function testEndpoint(endpoint) {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = 'Carregando...';
            responseArea.className = 'response-area loading';
            
            try {
                let url;
                if (endpoint === 'health') {
                    url = 'http://localhost:3000/health';
                } else {
                    url = `${API_BASE}/${endpoint}`;
                }
                
                const response = await fetch(url);
                const data = await response.json();
                
                responseArea.textContent = JSON.stringify(data, null, 2);
                responseArea.className = 'response-area';
            } catch (error) {
                responseArea.textContent = `Erro: ${error.message}`;
                responseArea.className = 'response-area';
            }
        }
        
        async function createSampleOrg() {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = 'Funcionalidade em desenvolvimento...\n\nPara criar uma organiza√ß√£o, use a API diretamente:\n\nPOST /api/auth/register\n{\n  "email": "admin@academia.com",\n  "password": "senha123",\n  "firstName": "Jo√£o",\n  "lastName": "Silva",\n  "organizationName": "Academia Elite Krav Maga"\n}';
        }
        
        async function createSampleStudent() {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = 'Funcionalidade em desenvolvimento...\n\nPara criar um aluno, use a API:\n\nPOST /api/students\n{\n  "email": "aluno@email.com",\n  "firstName": "Maria",\n  "lastName": "Santos",\n  "category": "ADULT"\n}';
        }
        
        async function createSampleTechnique() {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = 'Funcionalidade em desenvolvimento...\n\nPara criar uma t√©cnica, use a API:\n\nPOST /api/techniques\n{\n  "name": "Guarda de Boxe",\n  "description": "Posi√ß√£o b√°sica de defesa",\n  "category": "DEFENSE",\n  "difficulty": 1\n}';
        }
        
        async function testAnalytics() {
            const responseArea = document.getElementById('responseArea');
            responseArea.textContent = 'Analytics em desenvolvimento...\n\nFuncionalidades dispon√≠veis:\n- An√°lise de frequ√™ncia de alunos\n- Risco de abandono (IA)\n- Performance por t√©cnica\n- Relat√≥rios de progresso\n- Insights personalizados';
        }
        
        // Auto-refresh status every 30 seconds
        setInterval(checkServerStatus, 30000);
    </script>
</body>
</html>