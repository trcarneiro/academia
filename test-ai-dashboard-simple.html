<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste AI Dashboard - Simplificado</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .test-header h1 {
            color: #333;
            margin: 0 0 10px 0;
        }
        
        .test-header p {
            color: #666;
            margin: 0;
        }
        
        .test-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .test-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .test-btn-primary {
            background: #3b82f6;
            color: white;
        }
        
        .test-btn-primary:hover {
            background: #2563eb;
        }
        
        .test-btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .test-btn-secondary:hover {
            background: #4b5563;
        }
        
        .test-btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .test-btn-danger:hover {
            background: #dc2626;
        }
        
        .test-status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
        
        .test-status.success {
            background: #d1fae5;
            color: #065f46;
            border-left: 4px solid #10b981;
        }
        
        .test-status.error {
            background: #fee2e2;
            color: #991b1b;
            border-left: 4px solid #ef4444;
        }
        
        .test-status.info {
            background: #dbeafe;
            color: #1e40af;
            border-left: 4px solid #3b82f6;
        }
        
        .test-section {
            margin-bottom: 30px;
        }
        
        .test-section h3 {
            margin: 0 0 15px 0;
            color: #333;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 10px;
        }
        
        .test-module-info {
            background: #f9fafb;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .test-module-info pre {
            margin: 0;
            font-size: 12px;
            color: #666;
        }
        
        #ai-dashboard-container {
            min-height: 600px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 20px;
            background: #f9fafb;
        }
        
        /* Basic AI Dashboard Styles */
        .ai-dashboard {
            display: none;
        }
        
        .ai-dashboard.active {
            display: block;
        }
        
        .ai-dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .ai-dashboard-header h2 {
            margin: 0 0 10px 0;
        }
        
        .ai-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .ai-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .ai-tab.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
        }
        
        .ai-tab-content {
            display: none;
        }
        
        .ai-tab-content.active {
            display: block;
        }
        
        .student-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }
        
        .student-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #3b82f6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin-right: 20px;
        }
        
        .student-info {
            flex: 1;
        }
        
        .student-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .student-details {
            color: #666;
            font-size: 14px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: #3b82f6;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>ðŸ§  Teste AI Dashboard - Simplificado</h1>
            <p>Testando o mÃ³dulo AI Student Data Agent</p>
        </div>
        
        <div class="test-controls">
            <button class="test-btn test-btn-primary" onclick="testModuleLoading()">
                <i class="fas fa-play"></i> Testar Carregamento
            </button>
            <button class="test-btn test-btn-secondary" onclick="testBasicFunctionality()">
                <i class="fas fa-cog"></i> Testar Funcionalidade
            </button>
            <button class="test-btn test-btn-secondary" onclick="testMockAPI()">
                <i class="fas fa-user"></i> Testar Mock API
            </button>
            <button class="test-btn test-btn-secondary" onclick="showDashboard()">
                <i class="fas fa-eye"></i> Mostrar Dashboard
            </button>
            <button class="test-btn test-btn-danger" onclick="clearDashboard()">
                <i class="fas fa-trash"></i> Limpar
            </button>
        </div>
        
        <div id="test-status" class="test-status info">
            Aguardando teste...
        </div>
        
        <div class="test-section">
            <h3>InformaÃ§Ãµes do MÃ³dulo</h3>
            <div class="test-module-info">
                <pre id="module-info">
Nenhuma informaÃ§Ã£o disponÃ­vel
                </pre>
            </div>
        </div>
        
        <div class="test-section">
            <h3>AI Dashboard (Simplificado)</h3>
            <div id="ai-dashboard-container">
                <div class="loading-spinner" id="loading-spinner">
                    <div class="spinner"></div>
                    <p>Carregando...</p>
                </div>
                
                <!-- AI Dashboard Interface -->
                <div class="ai-dashboard" id="ai-dashboard">
                    <div class="ai-dashboard-header">
                        <h2>ðŸ§  AI Student Data Agent</h2>
                        <p>AnÃ¡lise inteligente de dados do aluno</p>
                    </div>
                    
                    <div class="ai-tabs">
                        <button class="ai-tab active" onclick="showTab(event, 'overview')">VisÃ£o Geral</button>
                        <button class="ai-tab" onclick="showTab(event, 'courses')">Cursos</button>
                        <button class="ai-tab" onclick="showTab(event, 'attendance')">FrequÃªncia</button>
                        <button class="ai-tab" onclick="showTab(event, 'insights')">Insights AI</button>
                    </div>
                    
                    <!-- Overview Tab -->
                    <div class="ai-tab-content active" id="overview-tab">
                        <div class="student-card">
                            <div style="display: flex; align-items: center;">
                                <div class="student-avatar">ðŸ‘¤</div>
                                <div class="student-info">
                                    <div class="student-name" id="student-name">Carlos Silva</div>
                                    <div class="student-details">
                                        <div>Email: carlos.silva@email.com</div>
                                        <div>Telefone: (11) 99999-8888</div>
                                        <div>ID: 12345678</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-value" id="total-courses">3</div>
                                <div class="metric-label">Cursos Ativos</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="attendance-rate">85%</div>
                                <div class="metric-label">Taxa de FrequÃªncia</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="progress-level">72%</div>
                                <div class="metric-label">Progresso Geral</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="engagement-score">8.5</div>
                                <div class="metric-label">Score de Engajamento</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Courses Tab -->
                    <div class="ai-tab-content" id="courses-tab">
                        <div class="student-card">
                            <h3>ðŸ“š Cursos Matriculados</h3>
                            <div id="courses-list">
                                <div>â€¢ Krav Maga Faixa Branca - Ativo</div>
                                <div>â€¢ Defesa Pessoal - In Progress</div>
                                <div>â€¢ Condicionamento FÃ­sico - Ativo</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Attendance Tab -->
                    <div class="ai-tab-content" id="attendance-tab">
                        <div class="student-card">
                            <h3>ðŸ“Š HistÃ³rico de FrequÃªncia</h3>
                            <div id="attendance-summary">
                                <div>â€¢ Ãšltimo mÃªs: 23 aulas de 27</div>
                                <div>â€¢ Meses anteriores: 85% mÃ©dia</div>
                                <div>â€¢ TendÃªncia: EstÃ¡vel</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Insights Tab -->
                    <div class="ai-tab-content" id="insights-tab">
                        <div class="student-card">
                            <h3>ðŸ¤– Insights AI</h3>
                            <div id="ai-insights">
                                <div>â€¢ <strong>PadrÃ£o de frequÃªncia:</strong> Regular com_zeros_segundas</div>
                                <div>â€¢ <strong>RecomendaÃ§Ã£o:</strong> Manter frequÃªncia atual</div>
                                <div>â€¢ <strong>Risco de abandono:</strong> Baixo (15%)</div>
                                <div>â€¢ <strong>Oportunidade:</strong> Considerar curso avanÃ§ado</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables for tracking
        let moduleLoaded = false;
        let dashboardVisible = false;
        
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('test-status');
            status.textContent = message;
            status.className = `test-status ${type}`;
        }
        
        function updateModuleInfo() {
            const info = document.getElementById('module-info');
            const infoData = {
                moduleLoaded: moduleLoaded ? 'âœ… Carregado' : 'âŒ NÃ£o carregado',
                dashboardVisible: dashboardVisible ? 'âœ… VisÃ­vel' : 'âŒ Oculto',
                browserSupport: typeof window.fetch !== 'undefined' ? 'âœ… ES6+' : 'âŒ Incompleto',
                localStorage: typeof localStorage !== 'undefined' ? 'âœ… DisponÃ­vel' : 'âŒ NÃ£o disponÃ­vel'
            };
            
            info.textContent = JSON.stringify(infoData, null, 2);
        }
        
        function testModuleLoading() {
            updateStatus('Testando ambiente do navegador...', 'info');
            
            try {
                // Test basic browser capabilities
                const features = {
                    fetch: typeof fetch !== 'undefined',
                    Promise: typeof Promise !== 'undefined',
                    ES6Modules: typeof import !== 'undefined',
                    localStorage: typeof localStorage !== 'undefined'
                };
                
                const allSupported = Object.values(features).every(Boolean);
                
                if (allSupported) {
                    moduleLoaded = true;
                    updateStatus('âœ… Ambiente suporta ES6+ e todas as features necessÃ¡rias', 'success');
                } else {
                    updateStatus('âš ï¸ Algumas features ES6+ nÃ£o estÃ£o disponÃ­veis', 'error');
                }
                
                console.log('Browser Features:', features);
                updateModuleInfo();
                
            } catch (error) {
                updateStatus(`âŒ Erro ao testar ambiente: ${error.message}`, 'error');
            }
        }
        
        function testBasicFunctionality() {
            updateStatus('Testando funcionalidades bÃ¡sicas...', 'info');
            
            try {
                // Test mock data generation
                const mockStudent = {
                    id: '1',
                    fullName: 'Carlos Silva',
                    email: 'carlos.silva@email.com',
                    phone: '(11) 99999-8888',
                    courses: 3,
                    attendanceRate: 85,
                    progressLevel: 72,
                    engagementScore: 8.5
                };
                
                // Mock API call
                setTimeout(() => {
                    updateStatus(`âœ… API Mock bem-sucedida para aluno: ${mockStudent.fullName}`, 'success');
                    updateModuleInfo();
                }, 1000);
                
            } catch (error) {
                updateStatus(`âŒ Erro ao testar funcionalidades: ${error.message}`, 'error');
            }
        }
        
        function testMockAPI() {
            updateStatus('Testando API Mock do MCP...', 'info');
            
            try {
                // Simulate MCP server response
                const mockResponse = {
                    success: true,
                    data: {
                        student: {
                            id: '1',
                            user: {
                                firstName: 'Carlos',
                                lastName: 'Silva',
                                email: 'carlos.silva@email.com',
                                phone: '(11) 99999-8888'
                            },
                            category: 'ADULT',
                            isActive: true,
                            birthDate: '1990-05-15'
                        },
                        subscriptions: [
                            {
                                id: 'sub1',
                                plan: { name: 'Mensal Krav Maga' },
                                status: 'ACTIVE',
                                course: { name: 'Krav Maga Faixa Branca' }
                            }
                        ],
                        attendance: [
                            {
                                id: 'att1',
                                class: { name: 'Aula de TerÃ§a' },
                                status: 'PRESENT',
                                checkInTime: '2025-01-13T18:30:00Z'
                            }
                        ]
                    }
                };
                
                setTimeout(() => {
                    const student = mockResponse.data.student;
                    updateStatus(`âœ… Dados do aluno retornados: ${student.user.firstName} ${student.user.lastName}`, 'success');
                    
                    // Update dashboard with real data
                    document.getElementById('student-name').textContent = 
                        `${student.user.firstName} ${student.user.lastName}`;
                    
                    updateModuleInfo();
                }, 1500);
                
            } catch (error) {
                updateStatus(`âŒ Erro ao testar API Mock: ${error.message}`, 'error');
            }
        }
        
        function showDashboard() {
            updateStatus('Mostrando Dashboard AI...', 'info');
            
            try {
                const dashboard = document.getElementById('ai-dashboard');
                const spinner = document.getElementById('loading-spinner');
                
                // Show loading
                spinner.style.display = 'block';
                dashboard.classList.remove('active');
                
                // Simulate loading delay
                setTimeout(() => {
                    spinner.style.display = 'none';
                    dashboard.classList.add('active');
                    dashboardVisible = true;
                    updateStatus('âœ… Dashboard AI carregado com sucesso!', 'success');
                    
                    // Animate metrics
                    animateMetrics();
                    updateModuleInfo();
                }, 2000);
                
            } catch (error) {
                updateStatus(`âŒ Erro ao mostrar dashboard: ${error.message}`, 'error');
            }
        }
        
        function animateMetrics() {
            const metrics = [
                { id: 'total-courses', target: 3, suffix: '' },
                { id: 'attendance-rate', target: 85, suffix: '%' },
                { id: 'progress-level', target: 72, suffix: '%' },
                { id: 'engagement-score', target: 8.5, suffix: '' }
            ];
            
            metrics.forEach(metric => {
                const element = document.getElementById(metric.id);
                let current = 0;
                const increment = metric.target / 20;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= metric.target) {
                        current = metric.target;
                        clearInterval(timer);
                    }
                    element.textContent = Math.round(current) + metric.suffix;
                }, 50);
            });
        }
        
        function clearDashboard() {
            updateStatus('Limpando dashboard...', 'info');
            
            try {
                const dashboard = document.getElementById('ai-dashboard');
                const spinner = document.getElementById('loading-spinner');
                
                dashboard.classList.remove('active');
                spinner.style.display = 'none';
                dashboardVisible = false;
                
                updateStatus('âœ… Dashboard limpo com sucesso!', 'success');
                updateModuleInfo();
                
            } catch (error) {
                updateStatus(`âŒ Erro ao limpar dashboard: ${error.message}`, 'error');
            }
        }
        
        function showTab(event, tabName) {
            const clickedTab = event.target;
            
            // Hide all tabs and contents
            document.querySelectorAll('.ai-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.ai-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab and content
            clickedTab.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }
        
        // Auto-test on load
        window.addEventListener('load', () => {
            updateStatus('PÃ¡gina carregada. Clique nos botÃµes para testar...', 'info');
            testModuleLoading();
        });
    </script>
</body>
</html>
