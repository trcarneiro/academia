<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat com Agentes - Academia</title>
</head>
<body>
    <div id="agent-chat-page" class="page-container">
        <!-- Breadcrumb -->
        <nav class="breadcrumb">
            <a href="#dashboard">Home</a>
            <span>‚Ä∫</span>
            <span>Chat com Agentes</span>
        </nav>

        <!-- Container principal do chat -->
        <div id="agent-chat-main-container"></div>
    </div>

    <script>
        // Inicializar m√≥dulo de chat
        (async function() {
            console.log('üí¨ [Agent Chat Page] Initializing...');
            
            const container = document.getElementById('agent-chat-main-container');
            
            if (!container) {
                console.error('‚ùå [Agent Chat Page] Container not found');
                return;
            }

            // Aguardar AgentChatModule estar dispon√≠vel
            const maxRetries = 50;
            let retries = 0;
            
            const waitForModule = setInterval(async () => {
                retries++;
                
                if (typeof window.AgentChatModule !== 'undefined') {
                    clearInterval(waitForModule);
                    
                    // Criar inst√¢ncia do m√≥dulo
                    const chatModule = new window.AgentChatModule(container);
                    
                    try {
                        await chatModule.init();
                        console.log('‚úÖ [Agent Chat Page] Module initialized');
                    } catch (error) {
                        console.error('‚ùå [Agent Chat Page] Error:', error);
                        container.innerHTML = `
                            <div class="error-state">
                                <h2>‚ùå Erro ao carregar chat</h2>
                                <p>${error.message}</p>
                                <button onclick="location.reload()">Recarregar p√°gina</button>
                            </div>
                        `;
                    }
                } else if (retries >= maxRetries) {
                    clearInterval(waitForModule);
                    console.error('‚ùå [Agent Chat Page] Module not loaded after 50 retries');
                    container.innerHTML = `
                        <div class="error-state">
                            <h2>‚ö†Ô∏è M√≥dulo n√£o carregado</h2>
                            <p>O m√≥dulo de chat n√£o foi carregado corretamente.</p>
                            <button onclick="location.reload()">Recarregar p√°gina</button>
                        </div>
                    `;
                }
            }, 100);
        })();
    </script>

    <style>
        #agent-chat-page {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .breadcrumb {
            margin-bottom: 1.5rem;
            color: #718096;
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        #agent-chat-main-container {
            min-height: 700px;
        }

        .error-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #718096;
        }

        .error-state h2 {
            margin-bottom: 1rem;
            color: #2d3748;
        }

        .error-state button {
            margin-top: 1.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
        }

        .error-state button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Mobile */
        @media (max-width: 768px) {
            #agent-chat-page {
                padding: 1rem;
            }

            #agent-chat-main-container {
                min-height: 500px;
            }
        }
    </style>
</body>
</html>
