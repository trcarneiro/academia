<!-- RAG Module - Sistema de Knowledge Base Inteligente -->
<div class="rag-isolated">
    <!-- GUIDELINES2.MD: Header Premium Enhanced -->
    <header class="module-header-premium">
        <div class="header-left">
            <div class="breadcrumb">
                <span>Home</span> / <span>Sistema</span> / <span class="active">RAG</span>
            </div>
            <h1 class="page-title">
                <span class="title-icon">ğŸ§ </span>
                RAG Knowledge System
            </h1>
            <p class="page-subtitle">Datalake Inteligente e Chat com IA para Academia</p>
        </div>
        <div class="header-actions">
            <button class="btn btn-secondary" onclick="window.router?.navigateTo('dashboard')">
                â† Voltar ao Dashboard
            </button>
        </div>
    </header>

    <!-- GUIDELINES2.MD: Stats Cards Enhanced -->
    <div class="stats-grid">
        <div class="stat-card-enhanced">
            <div class="stat-icon">ğŸ“š</div>
            <div class="stat-value" id="ragDocuments">0</div>
            <div class="stat-label">Documentos no RAG</div>
        </div>
        <div class="stat-card-enhanced">
            <div class="stat-icon">ğŸ§ </div>
            <div class="stat-value" id="ragEmbeddings">0</div>
            <div class="stat-label">Embeddings Criados</div>
        </div>
        <div class="stat-card-enhanced">
            <div class="stat-icon">ğŸ’¬</div>
            <div class="stat-value" id="ragQueries">0</div>
            <div class="stat-label">Consultas Hoje</div>
        </div>
        <div class="stat-card-enhanced">
            <div class="stat-icon">ğŸ¯</div>
            <div class="stat-value" id="ragAccuracy">95%</div>
            <div class="stat-label">PrecisÃ£o das Respostas</div>
        </div>
    </div>

    <!-- RAG Navigation Tabs -->
    <div class="rag-tabs">
        <button class="tab-btn active" data-tab="upload" onclick="showTab('upload')">
            <span class="tab-icon">ğŸ“„</span>
            <span class="tab-text">Upload & IngestÃ£o</span>
        </button>
        <button class="tab-btn" data-tab="library" onclick="showTab('library')">
            <span class="tab-icon">ğŸ“š</span>
            <span class="tab-text">Biblioteca</span>
        </button>
        <button class="tab-btn" data-tab="chat" onclick="showTab('chat')">
            <span class="tab-icon">ğŸ’¬</span>
            <span class="tab-text">Chat RAG</span>
        </button>
        <button class="tab-btn" data-tab="generate" onclick="showTab('generate')">
            <span class="tab-icon">âš¡</span>
            <span class="tab-text">GeraÃ§Ã£o</span>
        </button>
    </div>

    <!-- Tab Content: Upload & IngestÃ£o -->
    <div class="tab-content active" id="upload-tab">
        <div class="data-card-premium">
            <div class="card-header">
                <h2 class="card-title">ğŸ“„ Upload de Documentos para RAG</h2>
                <p class="card-subtitle">Adicione conhecimento Ã  base de dados inteligente</p>
            </div>
            
            <div class="upload-section">
                <div class="upload-area-rag">
                    <input type="file" id="ragDocumentFile" accept=".pdf,.doc,.docx,.txt,.md" multiple style="display: none;">
                    <div class="upload-zone-rag" onclick="document.getElementById('ragDocumentFile').click()">
                        <div class="upload-icon">ğŸ“¤</div>
                        <div class="upload-text">
                            <strong>Clique para selecionar documentos</strong>
                            <br>ou arraste e solte aqui
                        </div>
                        <div class="upload-hint">
                            Formatos: PDF, DOC, DOCX, TXT, MD (mÃ¡x. 50MB por arquivo)
                        </div>
                    </div>
                </div>
                
                <div class="upload-options">
                    <div class="form-group">
                        <label for="documentCategory">Categoria do Documento</label>
                        <select id="documentCategory" class="form-select">
                            <option value="krav-maga">Krav Maga - TÃ©cnicas</option>
                            <option value="defesa-pessoal">Defesa Pessoal</option>
                            <option value="condicionamento">Condicionamento FÃ­sico</option>
                            <option value="pedagogia">Pedagogia e Ensino</option>
                            <option value="filosofia">Filosofia Marcial</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="documentTags">Tags (opcional)</label>
                        <input type="text" id="documentTags" class="form-input" 
                               placeholder="Ex: iniciante, avanÃ§ado, autodefesa">
                    </div>
                </div>
                
                <button id="startIngestionBtn" class="btn btn-primary" style="display: none;">
                    ğŸš€ Iniciar Processamento RAG
                </button>
            </div>
            
            <div id="ingestionProgress" class="ingestion-progress" style="display: none;">
                <div class="progress-header">
                    <span class="progress-icon">ğŸ”„</span>
                    <span class="progress-title">Processando documentos...</span>
                </div>
                <div class="progress-steps">
                    <div class="step-item" id="step-upload">
                        <span class="step-icon">ğŸ“¤</span>
                        <span class="step-text">Upload</span>
                    </div>
                    <div class="step-item" id="step-extract">
                        <span class="step-icon">ğŸ“„</span>
                        <span class="step-text">ExtraÃ§Ã£o</span>
                    </div>
                    <div class="step-item" id="step-chunk">
                        <span class="step-icon">âœ‚ï¸</span>
                        <span class="step-text">Chunking</span>
                    </div>
                    <div class="step-item" id="step-embed">
                        <span class="step-icon">ğŸ§ </span>
                        <span class="step-text">Embeddings</span>
                    </div>
                    <div class="step-item" id="step-store">
                        <span class="step-icon">ğŸ’¾</span>
                        <span class="step-text">Armazenamento</span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="ingestionProgressBar"></div>
                </div>
                <div class="progress-details" id="ingestionDetails">
                    Aguardando inÃ­cio do processamento...
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: Biblioteca -->
    <div class="tab-content" id="library-tab" style="display: none;">
        <div class="data-card-premium">
            <div class="card-header">
                <h2 class="card-title">ğŸ“š Biblioteca de Conhecimento</h2>
                <p class="card-subtitle">Documentos processados e disponÃ­veis no RAG</p>
            </div>
            
            <div class="library-filters">
                <div class="filter-group">
                    <label for="librarySearch">Buscar documentos</label>
                    <input type="text" id="librarySearch" class="form-input" 
                           placeholder="Buscar por nome, categoria ou tags...">
                </div>
                <div class="filter-group">
                    <label for="libraryCategory">Filtrar por categoria</label>
                    <select id="libraryCategory" class="form-select">
                        <option value="">Todas as categorias</option>
                        <option value="krav-maga">Krav Maga</option>
                        <option value="defesa-pessoal">Defesa Pessoal</option>
                        <option value="condicionamento">Condicionamento</option>
                        <option value="pedagogia">Pedagogia</option>
                        <option value="filosofia">Filosofia</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
            </div>
            
            <div id="documentsGrid" class="documents-grid">
                <!-- Documentos serÃ£o carregados aqui -->
                <div class="document-card placeholder">
                    <div class="doc-icon">ğŸ“„</div>
                    <div class="doc-info">
                        <h4>Nenhum documento encontrado</h4>
                        <p>FaÃ§a upload de documentos na aba "Upload & IngestÃ£o"</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: Chat RAG -->
    <div class="tab-content" id="chat-tab" style="display: none;">
        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-info">
                    <span class="chat-icon">ğŸ§ </span>
                    <div class="chat-title">
                        <h3>RAG Assistant</h3>
                        <p>Converse com a base de conhecimento da academia</p>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="btn btn-secondary btn-sm" onclick="clearChat()">
                        ğŸ—‘ï¸ Limpar Chat
                    </button>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message assistant">
                    <div class="message-avatar">ğŸ§ </div>
                    <div class="message-content">
                        <div class="message-text">
                            OlÃ¡! Sou o assistente RAG da academia. Posso responder perguntas sobre:
                            <ul>
                                <li>ğŸ¥‹ TÃ©cnicas de Krav Maga</li>
                                <li>ğŸ›¡ï¸ Defesa pessoal</li>
                                <li>ğŸ’ª Condicionamento fÃ­sico</li>
                                <li>ğŸ“š Metodologias de ensino</li>
                                <li>ğŸ§˜ Filosofia marcial</li>
                            </ul>
                            O que gostaria de saber?
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <input type="text" id="chatInput" class="chat-input" 
                           placeholder="Digite sua pergunta sobre Krav Maga ou defesa pessoal...">
                    <button id="sendMessageBtn" class="btn btn-primary btn-send">
                        <span class="send-icon">ğŸ“¤</span>
                    </button>
                </div>
                <div class="chat-suggestions">
                    <button class="suggestion-btn" onclick="askSuggestion('Como executar um soco direto?')">
                        Como executar um soco direto?
                    </button>
                    <button class="suggestion-btn" onclick="askSuggestion('Quais sÃ£o os princÃ­pios do Krav Maga?')">
                        Quais sÃ£o os princÃ­pios do Krav Maga?
                    </button>
                    <button class="suggestion-btn" onclick="askSuggestion('Como se defender de um estrangulamento?')">
                        Como se defender de um estrangulamento?
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Content: GeraÃ§Ã£o -->
    <div class="tab-content" id="generate-tab" style="display: none;">
        <div class="data-card-premium">
            <div class="card-header">
                <h2 class="card-title">âš¡ GeraÃ§Ã£o de ConteÃºdo com RAG</h2>
                <p class="card-subtitle">Crie tÃ©cnicas, planos de aula e cursos usando a base de conhecimento</p>
            </div>
            
            <div class="generation-types">
                <div class="generation-card" onclick="selectGenerationType('technique')">
                    <div class="gen-icon">ğŸ¥‹</div>
                    <div class="gen-content">
                        <h3>Gerar TÃ©cnica</h3>
                        <p>Nova tÃ©cnica baseada no conhecimento da academia</p>
                    </div>
                </div>
                
                <div class="generation-card" onclick="selectGenerationType('lesson')">
                    <div class="gen-icon">ğŸ“</div>
                    <div class="gen-content">
                        <h3>Gerar Plano de Aula</h3>
                        <p>Plano estruturado com objetivos e atividades</p>
                    </div>
                </div>
                
                <div class="generation-card" onclick="selectGenerationType('course')">
                    <div class="gen-icon">ğŸ“</div>
                    <div class="gen-content">
                        <h3>Gerar MÃ³dulo de Curso</h3>
                        <p>MÃ³dulo completo com progressÃ£o pedagÃ³gica</p>
                    </div>
                </div>
                
                <div class="generation-card" onclick="selectGenerationType('evaluation')">
                    <div class="gen-icon">ğŸ“Š</div>
                    <div class="gen-content">
                        <h3>Gerar AvaliaÃ§Ã£o</h3>
                        <p>CritÃ©rios e mÃ©todos de avaliaÃ§Ã£o</p>
                    </div>
                </div>
            </div>
            
            <div id="generationForm" class="generation-form" style="display: none;">
                <!-- FormulÃ¡rio dinÃ¢mico baseado no tipo selecionado -->
            </div>
            
            <div id="generationResults" class="generation-results" style="display: none;">
                <!-- Resultados da geraÃ§Ã£o -->
            </div>
        </div>
    </div>
</div>
