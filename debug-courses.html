<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Courses Module</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #0f172a; 
            color: #f8fafc; 
        }
        .debug-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #334155; 
            border-radius: 8px;
            background: #1e293b;
        }
        .courses-header { 
            background: #334155; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 4px;
        }
        .courses-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 15px; 
        }
        .loading-container { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            padding: 40px; 
            background: #334155;
            border-radius: 8px;
        }
        .empty-state { 
            display: none; 
            text-align: center; 
            padding: 40px; 
            background: #334155;
            border-radius: 8px;
        }
        .courses-container { 
            display: none; 
            background: #1e293b;
            border-radius: 8px;
            padding: 20px;
        }
        .course-card { 
            border: 1px solid #475569; 
            padding: 15px; 
            border-radius: 8px; 
            background: #334155;
        }
        .action-button {
            padding: 8px 16px;
            margin: 5px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .console-output {
            background: #0f172a;
            padding: 15px;
            border: 1px solid #334155;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>ðŸ”§ Debug Courses Module</h1>
    
    <div class="debug-section">
        <h2>API Test</h2>
        <button class="action-button" onclick="testAPI()">Test /api/courses</button>
        <button class="action-button" onclick="testModuleLoad()">Test Module Load</button>
        <button class="action-button" onclick="testInitialization()">Test Initialization</button>
        <button class="action-button" onclick="clearConsole()">Clear Console</button>
    </div>
    
    <div class="debug-section">
        <h2>Mock Courses Page Elements</h2>
        <div class="courses-header">
            <h3>GestÃ£o de Cursos</h3>
        </div>
        
        <div id="loadingState" class="loading-container">
            <div>ðŸ”„ Carregando cursos...</div>
        </div>
        
        <div id="emptyState" class="empty-state">
            <div>ðŸ“­ Nenhum curso encontrado</div>
        </div>
        
        <div id="coursesContainer" class="courses-container">
            <div class="courses-grid" id="coursesGrid">
                <!-- Courses will be rendered here -->
            </div>
        </div>
    </div>
    
    <div class="debug-section">
        <h2>Console Output</h2>
        <div id="consoleOutput" class="console-output"></div>
    </div>

    <script>
        // Capture console logs
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        const consoleOutput = document.getElementById('consoleOutput');
        
        function addToConsole(type, ...args) {
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            const div = document.createElement('div');
            div.style.color = type === 'error' ? '#ef4444' : type === 'warn' ? '#f59e0b' : '#3b82f6';
            div.textContent = `[${type.toUpperCase()}] ${new Date().toLocaleTimeString()}: ${message}`;
            consoleOutput.appendChild(div);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole('log', ...args);
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole('error', ...args);
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole('warn', ...args);
        };
        
        // Test functions
        async function testAPI() {
            console.log('ðŸ§ª Testing API...');
            try {
                const response = await fetch('/api/courses');
                console.log('ðŸ“¡ Response status:', response.status);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('ðŸ“¦ API Data:', data);
                    console.log('âœ… API working correctly');
                } else {
                    console.error('âŒ API Error - Status:', response.status);
                }
            } catch (error) {
                console.error('âŒ Network Error:', error);
            }
        }
        
        function testModuleLoad() {
            console.log('ðŸ§ª Testing module load...');
            
            // Check if module functions exist
            console.log('ðŸ“‹ Module functions available:');
            console.log('- initializeCoursesModule:', typeof window.initializeCoursesModule);
            console.log('- initializeCoursesModuleWithRetry:', typeof window.initializeCoursesModuleWithRetry);
            console.log('- refreshCourses:', typeof window.refreshCourses);
            console.log('- viewCourse:', typeof window.viewCourse);
            console.log('- editCourse:', typeof window.editCourse);
            console.log('- deleteCourse:', typeof window.deleteCourse);
        }
        
        function testInitialization() {
            console.log('ðŸ§ª Testing initialization...');
            
            // Check for required elements
            console.log('ðŸ“‹ Required elements:');
            console.log('- .courses-header:', !!document.querySelector('.courses-header'));
            console.log('- #coursesGrid:', !!document.querySelector('#coursesGrid'));
            console.log('- #loadingState:', !!document.querySelector('#loadingState'));
            console.log('- #emptyState:', !!document.querySelector('#emptyState'));
            console.log('- #coursesContainer:', !!document.querySelector('#coursesContainer'));
            
            // Try manual initialization
            if (typeof window.initializeCoursesModule === 'function') {
                console.log('ðŸš€ Calling initializeCoursesModule...');
                window.initializeCoursesModule();
            } else if (typeof window.initializeCoursesModuleWithRetry === 'function') {
                console.log('ðŸš€ Calling initializeCoursesModuleWithRetry...');
                window.initializeCoursesModuleWithRetry();
            } else {
                console.error('âŒ No initialization functions available');
            }
        }
        
        function clearConsole() {
            consoleOutput.innerHTML = '';
        }
        
        // Auto-start on load
        window.addEventListener('load', () => {
            console.log('ðŸ”„ Page loaded, starting debug...');
            setTimeout(testAPI, 500);
            setTimeout(testModuleLoad, 1000);
        });
    </script>
    
    <!-- Load the courses module -->
    <script src="/js/modules/courses.js"></script>
</body>
</html>
